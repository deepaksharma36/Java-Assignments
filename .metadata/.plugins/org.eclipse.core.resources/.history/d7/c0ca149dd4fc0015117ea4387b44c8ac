import java.io.BufferedReader;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.IOException;


import org.apache.poi.xssf.usermodel.*;

public class TestCaseExecutor {
	XSSFWorkbook ResultBook = new XSSFWorkbook();
	XSSFSheet ResultSheet;
	File excelFile;
	Algo executableAlgo;
	
public TestCaseExecutor( String algoName, String fileName) {
	ResultSheet = ResultBook.createSheet(algoName);
	excelFile = new File(fileName);
	executableAlgo=AlgoFactory.createAlgo(algoName);
}	
public void TestExecutor(File testFile) throws IOException
{

	String sCurrentLine;
	
	String[] input;
	long startTime; 
	BufferedReader fileReader = new BufferedReader(new FileReader(testFile));
	int testCaseLength=1;
	Result algoResult;
	while ((sCurrentLine = fileReader.readLine()) != null) {
		
		input=sCurrentLine.split("\t");
		//startTime= System.currentTimeMillis(); 
		algoResult=executableAlgo.execute(); 
		
		//long stopTime = System.currentTimeMillis();
	    //long elapsedTime = stopTime - startTime;
	    recordResults(algoResult);}
	    
	}
	
	


	
private void recordResults(int testCaseLength, long Time ) throws FileNotFoundException
{
    XSSFRow executionRecordRow = ResultSheet.createRow(testCaseLength);
    XSSFCell lengthCell = executionRecordRow.createCell(0);
    lengthCell.setCellValue(testCaseLength);
    XSSFCell timeCell = executionRecordRow.createCell(1);
    timeCell.setCellValue(Time);

     FileOutputStream excelWriter = new FileOutputStream (this.excelFile,false);
     try {
		ResultBook.write(excelWriter);
	} catch (IOException e) {
	e.printStackTrace();
	}
     
}

}
